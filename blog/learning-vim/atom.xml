<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: learning_vim | RailsとRubyとVimのブログ]]></title>
  <link href="http://alpaca.tc/blog/learning-vim/atom.xml" rel="self"/>
  <link href="http://alpaca.tc/"/>
  <updated>2014-04-20T21:35:36+09:00</updated>
  <id>http://alpaca.tc/</id>
  <author>
    <name><![CDATA[alpaca-tc]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Vimを勉強し始めました #1]]></title>
    <link href="http://alpaca.tc/blog/learning_vim/i-begin-to-lean-vim-1.html"/>
    <updated>2013-11-21T09:11:00+09:00</updated>
    <id>http://alpaca.tc/blog/learning_vim/i-begin-to-lean-vim-1</id>
    <content type="html"><![CDATA[<h1>Vim読書会 #1</h1>

<p>先日から続けているVim読書会(一人)ですが、
今回からモチベーションのために記事にあげて行おうと思います。</p>

<p><em>本日読むソースコード</em></p>

<p><strong>Vim-0.3</strong></p>

<ul>
<li>cmdline.c</li>
<li>cmdtab.h</li>
<li>cmdcmds.c</li>
</ul>


<!-- more -->


<h2>cmdline.c L3723行</h2>

<p>cmdline.c: functions for reading in the command line and executing it</p>

<p><code>c
// L650:
static char_u * DoOneCmd(buff) char_u *buff; {
</code></p>

<p>この関数で、コマンドラインからの入力を処理してます。
関数の前半部分で入力をパースして、後半部分でコマンドを分岐しています。</p>

<p>分岐部分はこんな感じですね。</p>

<p>```c
L1111:
cmdswitch:
  switch (cmdidx)
  {</p>

<pre><code>/*
 * quit current window, quit Vim if closed the last window
 */
case CMD_quit:
  ...

case CMD_qall:
  ...
</code></pre>

<p>```</p>

<p><code>:quit</code>の処理を変更したかったら、<code>case CMD_quit</code>以下を変更すればいいです。</p>

<h2>cmdtab.h L337行</h2>

<p>また、<code>CMD_...</code>といった定数は<code>cmdtab.h</code>で初期化されており、全てのコマンドが定義されています。
コマンドは、ユニークなID,コマンド名,受け付ける引数がここで定義されます。</p>

<p>そのコマンドの実際の動作は、<code>cmdline.c</code>にべた書きされているという感じでしょうか。</p>

<p>Vim-3.0の書き方だと、コマンドがひとつ増える度に<code>cmdline.c</code>の分岐がひとつ増えるというヘビーな書き方なので、新しいバージョンではリファクタリングされてそう。</p>

<h2>cmdcmds.c L541行</h2>

<p>cmdcmds.c: functions for command line commands</p>

<p><code>cmdcmds.c</code>は、<code>cmdline.c</code>でのコマンドの分岐で重なる部分の関数をまとめたもの、といった印象です。
Wordpressでいうfunctionsのような感じかな。一応、他の場所でも使える感じに仕上がっています。</p>

<p>この中には、<code>do_align</code>や<code>doshell</code>といった、想像につく名前の関数がありますね。
<code>CMD_move</code>で分岐した場合は、こちらに飛ばされます。</p>

<h2>まとめ</h2>

<p>コマンド関連の細かい実装を見るのは大変ですが、全体的に見ると読みやすかったです。
Vimのオプションやコマンド名が、そのまま変数に使われているので読みやすかったです。</p>

<p><code>:echo</code>などのコマンドを追加する場合は、ここら辺を弄るだけでなんとかなりそうですね！
次回トライしてみます。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[そろそろVimを使いこなせるようになりたい。]]></title>
    <link href="http://alpaca.tc/blog/learning_vim/i-begin-to-learn-vim.html"/>
    <updated>2013-11-15T06:58:00+09:00</updated>
    <id>http://alpaca.tc/blog/learning_vim/i-begin-to-learn-vim</id>
    <content type="html"><![CDATA[<h1><strong>「俺、ちゃんとVimやるわ」</strong></h1>

<p>&hellip;と、夏の途中に宣言してからというもの、</p>

<p>「仕事がー」、「友達がー」、「本をー」と、何かと理由をつけて結局やってませんでした。。。</p>

<p>m(_ _)m &lt; 怠惰な人間です。クズです。生きててすみません。。。</p>

<p>はい。</p>

<p>今日からちゃんとVimと向き合いたいと思います。</p>

<!-- more -->


<h2>そして、僕は2歳のころの時代へ&hellip;</h2>

<p><img class="image_on_frame center" src="/images/blog/2013_11_15.png" title="The version of Vim" ></p>

<p>1994年というと、僕がおもらしをして20万円ぐらいするPCを破壊したぐらいの時期でしょうか。</p>

<p>これから、VimをVersion4に向けて再構築していきたいと思います。</p>
]]></content>
  </entry>
  
</feed>



