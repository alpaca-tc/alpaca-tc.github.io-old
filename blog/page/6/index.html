


<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>RailsとRubyとVimのブログ</title>
    
    <meta name="description" content="
  
  
    
    
      
  
    
      
        
          
            
              
                Vim中級者を脱する スコープ編
              
            ...">
    
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
    <meta content='RailsとRubyとVimのブログ' name='title' />

    
  <link rel="author" href="https://plus.google.com/105581201951227096827" />
  <link rel="publisher" href="https://plus.google.com/105581201951227096827" />


    <meta property="og:title" content='RailsとRubyとVimのブログ' />
<meta property="og:locale" content="ja_JP"/>
<meta property="og:image" content="https://http://alpaca.tc/images/meta/site_title.png"/>
<meta property="og:type" content="blog"/>
<meta property="og:url" content="http://alpaca.tc/blog/page/6/"/>
<meta property="og:site_name" content="RailsとRubyとVimのブログ"/>
<meta property="og:description" content="
  
  
    
    
      
  
    
      
        
          
            
              
                Vim中級者を脱する スコープ編
              
            ..." />
<meta property="fb:app_id" content="224701561024840" />

    <meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RailsとRubyとVimのブログ">
<meta name="twitter:description" content="
  
  
    
    
      
  
    
      
        
          
            
              
                Vim中級者を脱する スコープ編
              
            ...">
<meta name="twitter:image" content="https://http://alpaca.tc/images/meta/twitter.png">
<meta name="twitter:site" content="@alpaca_tc">
<meta name="twitter:creator" content="@alpaca_tc">


    <link rel="shortcut icon" href="/images/common/favicon.ico" type="image/x-icon">

    <script type="text/javascript">window._pt_lt = new Date().getTime();</script>

    <link rel="stylesheet" href="/stylesheets/main.css" type="text/css" media="all"/>
    <meta name="google-site-verification" content="thSL3cUT7BV1-AENglRFIF-kv6I85JJ6_iUGAU8GaQI" />

    <!--[if lte IE 8]>
      <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- [todo] - あとで修正するよー -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

    
  <script>
    var _gaq = _gaq || [];
    _gaq.push(['_require', 'inpage_linkid', '//www.google-analytics.com/plugins/ga/inpage_linkid.js']);
    _gaq.push(['_setAccount', 'UA-44082439-2']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'https://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>





  <link rel="next" href="7">



  <link rel="prev" href="5">



  <link rel="canonical" href="http://alpaca.tc/blog/page/6/">



  </head>
  <div id="fb-root"></div>

  <body id="default_contents">
    <div id="header_top" class="outer_envelope clearfix">
      <header>        <div class="inner_wrapper clearfix">
          <div class="inner clearfix">
            <div id="logo">
              
                <h1 id="site_title"><a href="/">RailsとRubyとVimのブログ</a></h1>
              
            </div>

            <nav id="header_nav">
              <ul class="clearfix">
                <li>
                  <a href="/about_me">About Me</a>
                </li>
                <li>
                  <a href="/">Blog</a>
                </li>
                <li>
                  <a href="/works/">Works</a>
                </li>
                <li>
                  <a target="_blank" href="https://github.com/alpaca-tc">GitHub</a>
                </li>
                <li>
                  <a target="_blank" href="https://twitter.com/alpaca_tc">Twitter</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
</header>

      <div id="main_contents" class="clearfix">
        <div class="inner_wrapper">
          <div class="inner">
            <div class="left_page inner_wrapper">
              <div id="page_contents" class="inner">
                <div id="index_contents" class="blog-index">
  
  
    
    <div class="blog-articles">
      <article class="post_row">
  <div class="inner">
    <header class="field-items">
      
        <h1>
          
            <a href="/blog/vim/break-vim-beginners-scope.html">
              
                Vim中級者を脱する スコープ編
              
            </a>
          
        </h1>
      

      
        <section class="meta">
          <div class="inner">
            










<time datetime="2013-11-13T17:26:00+09:00" pubdate data-updated="true"></time>
            
<span class="byline author">Posted by 石井浩之</span>

            

  <span class="categories">
    
      
    
  </span>


          </div>
        </section>
      
    </header>

    
      <section class="entry-content"><p>個人的に、Vimで一番ハマったのが<strong>スコープの問題</strong>でした。</p>

<p>vimrcのコピペばかりの、あなた。</p>

<p>せめて、よく登場するスコープだけでも理解してみましょう。</p>

<!-- more -->

<h1 id="よく見るスコープ一覧">よく見るスコープ一覧</h1>

<ul>
  <li><em>グローバル</em>スコープ　<code class="language-plaintext highlighter-rouge">g:</code></li>
  <li><em>関数内</em>スコープ　<code class="language-plaintext highlighter-rouge">a:</code></li>
  <li><em>スクリプト</em>スコープ　<code class="language-plaintext highlighter-rouge">s:</code></li>
  <li><em>バッファ</em>スコープ　<code class="language-plaintext highlighter-rouge">b:</code></li>
  <li><em>接頭辞なし</em>　<code class="language-plaintext highlighter-rouge">let huga=...</code>など</li>
</ul>

<h2 id="グローバルgスコープ">グローバル(g:)スコープ</h2>

<p><strong>どこからでも参照できます。</strong></p>

<p>プラグインの設定で見慣れたスコープですね。</p>

<p><code class="language-plaintext highlighter-rouge">let g:neocomplete#enable_at_startup = 1</code></p>

<p>変数を初期化するには、次のようにします。
大量のエラーコードによって操作できなくなるので、<strong>嫌いな人のvimrcの末尾に書き込んでください。</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for key in keys(g:)
  execute 'unlet g:' . key
endfor
</code></pre></div></div>

<h2 id="関数内aスコープ">関数内(a:)スコープ</h2>

<p><strong>関数内で、引数を参照するときに使用するスコープ</strong></p>

<p>個人的に一番理解しがたいスコープです。</p>

<p>こんな感じで使います。他言語から移ってきた人には、正直使いづらい。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function! Huga(first, second)
  echo a:first
  "=&gt; 'a'

  echo a:
  "=&gt; {'0': 0, '000': [], 'second': 'b', 'first': 'a', 'firstline': 5, 'lastline': 5}
endfunction

call Huga('a', 'b')
</code></pre></div></div>

<p>「あーなるほど、<strong>関数内でだけ有効なスコープなのか。</strong>」</p>

<p>と、思っていたら<em>それは間違い。</em></p>

<p>下記のようにすると、<strong>グローバルスコープとして参照できます。</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function! a:huga()
  echo 'Global!?!?!?'
endfunction

call a:huga() " =&gt; Global!?!?!?
</code></pre></div></div>

<p>実は、これ関数名に<code class="language-plaintext highlighter-rouge">:</code>が許可されているだけです。
なので実際は<code class="language-plaintext highlighter-rouge">a:</code>スコープは関係ないんだけど、分かりづらい。</p>

<h2 id="スクリプトsスコープ">スクリプト(s:)スコープ</h2>

<p><strong>ファイル内でのみ有効なスコープ</strong>です。</p>

<p>プラグインで、プライベートなメソッドや定数を作るときによく使います。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let s:script_scope = '外部からは参照できない'
function! s:script_scope_method()
  " プライベートメソッドとしてよく使われる
endfunction
</code></pre></div></div>

<p>この<code class="language-plaintext highlighter-rouge">s:</code>は、スクリプトがsourceされるときに置き換えられ、<code class="language-plaintext highlighter-rouge">&lt;SNR&gt;1_...</code>という感じの形になります。</p>

<p>えぇ、そうです。すると、<strong>グローバルなスコープとして参照できます。</strong></p>

<p>この<code class="language-plaintext highlighter-rouge">&lt;SNR&gt;</code>の後にどの数値が割り振られているかは、<code class="language-plaintext highlighter-rouge">:scriptnames</code>で参照できます。</p>

<p>また、<code class="language-plaintext highlighter-rouge">s:</code>は<code class="language-plaintext highlighter-rouge">&lt;SID&gt;</code>として使えばスコープを超えて使用できるようになります。</p>

<p>マッピングの時に、scriptスコープを使う時などは必須ですね。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nnoremap s :echo &lt;SID&gt;SID()&lt;CR&gt;
</code></pre></div></div>

<p>ただし、<strong>変数は基本的には聖域</strong>です。</p>

<h2 id="バッファbスコープ">バッファ(b:)スコープ</h2>

<p><strong>バッファ単位のスコープ</strong>です。</p>

<p>ファイルタイプによる設定や、一時バッファによる変数などに使います。</p>

<ul>
  <li>ファイルタイプの変更で、<code class="language-plaintext highlighter-rouge">b:current_syntax</code>などが初期化&amp;格納されます</li>
  <li>Uniteを起動で、<code class="language-plaintext highlighter-rouge">b:unite</code>にデータが格納されます。</li>
</ul>

<p>Uniteのデバッグするときには、<code class="language-plaintext highlighter-rouge">echo b:unite.candidates</code>などを参照しましょう。</p>

<p>あぁ、ようやくまともなスコープだ。</p>

<h2 id="接頭辞なしlet-huga変数">接頭辞なし(<code class="language-plaintext highlighter-rouge">let huga=</code>)変数</h2>

<p>えぇ。<strong>グローバルなスコープです。</strong></p>

<p>お前もか！</p>

<p>マナーとしては、やはり<code class="language-plaintext highlighter-rouge">g:</code>で宣言したいところですが、</p>

<p>Vimにデフォルトで入っているプラグインは、容赦なくこの変数を使ってきます。</p>

<p><code class="language-plaintext highlighter-rouge">:echo loaded_*&lt;Tab&gt;</code>などすれば、奴らを見つけられるはずです。</p>

<p>細かいことを言えば、関数内ならばローカルスコープです。。。</p>

<h2 id="スコープのまとめ">スコープのまとめ</h2>

<ul>
  <li>スコープは<strong>ほとんどグローバルで参照できる</strong></li>
  <li>VimLは枠にハマらない<strong>素敵な</strong>言語仕様を持っている</li>
  <li>getbufvar()などでスコープへアクセス出来るため、<strong>聖域はほとんど無い</strong></li>
</ul>

<p><strong>正直今でも理解出来ていない。</strong></p>
</section>
      

      
    

    
      





<section class="sharing clearfix">
  <div class="button ft_like_button">
    <div class="fb-like" data-href="http://alpaca.tc/blog/vim/break-vim-beginners-scope.html" data-colorscheme="light" data-layout="button_count" data-action="like" data-show-faces="false" data-send="false"></div>
  </div>

  <div class="button ft_share_button">
    <div class="fb-share-button" data-href="http://alpaca.tc/blog/vim/break-vim-beginners-scope.html" data-type="button_count"></div>
  </div>

  <div class="button hatena_bookmark_button">
    <a href="https://b.hatena.ne.jp/entry/http://alpaca.tc/blog/vim/break-vim-beginners-scope.html" class="hatena-bookmark-button" data-hatena-bookmark-title="
Vim中級者を脱する スコープ編 | RailsとRubyとVimのブログ 
" data-hatena-bookmark-layout="small" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
  </div>

  <div class="button google_plus_button_like">
    <div data-annotation="none" data-href="http://alpaca.tc/blog/vim/break-vim-beginners-scope.html" class="g-plusone" data-size="medium" ></div>
  </div>

  <div class="button twitter_button">
    <a href="https://twitter.com/share" class="twitter-share-button"  data-url="http://alpaca.tc/blog/vim/break-vim-beginners-scope.html" data-via="alpaca_tc" date-width="120" data-counturl="http://alpaca.tc/blog/vim/break-vim-beginners-scope.html" ></a>
  </div>
</section>

    
  </div>
</article>

    </div>
  
    
    <div class="blog-articles">
      <article class="post_row">
  <div class="inner">
    <header class="field-items">
      
        <h1>
          
            <a href="/blog/vim/how-to-use-tern-vim.html">
              
                JavaScript補完プラグインのTernはすごいヤツ
              
            </a>
          
        </h1>
      

      
        <section class="meta">
          <div class="inner">
            










<time datetime="2013-11-13T14:40:00+09:00" pubdate data-updated="true"></time>
            
<span class="byline author">Posted by 石井浩之</span>

            

  <span class="categories">
    
      
    
  </span>


          </div>
        </section>
      
    </header>

    
      <section class="entry-content"><p><strong>「え、JavaScriptを書いているのに、Tern使ってないの？」</strong></p>

<p>ダサい。イケてない。
あぁ、残念。</p>

<!-- more -->

<p><a href="https://github.com/marijnh/tern">Tern</a>は、marijnhという凄いエンジニアの人が作っている<strong>JavaScriptの動的補完プラグイン</strong></p>

<p>コードを動的にパースして、今カーソルがある変数の型まで調べて補完しちゃってくれる。</p>

<p>設定をすれば、jQueryなどのプラグインでの諸々も補完しちゃう凄いやつなのだ。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if has('python') &amp;&amp; executable('npm')
  NeoBundleLazy 'marijnh/tern_for_vim', {
        \ 'build' : 'npm install',
        \ 'autoload' : {
        \   'functions': ['tern#Complete', 'tern#Enable'],
        \   'filetypes' : 'javascript'
        \ }}
endif
</code></pre></div></div>

<p>まぁ、何はともあれ一度使ってみてください。</p>
</section>
      

      
    

    
      





<section class="sharing clearfix">
  <div class="button ft_like_button">
    <div class="fb-like" data-href="http://alpaca.tc/blog/vim/how-to-use-tern-vim.html" data-colorscheme="light" data-layout="button_count" data-action="like" data-show-faces="false" data-send="false"></div>
  </div>

  <div class="button ft_share_button">
    <div class="fb-share-button" data-href="http://alpaca.tc/blog/vim/how-to-use-tern-vim.html" data-type="button_count"></div>
  </div>

  <div class="button hatena_bookmark_button">
    <a href="https://b.hatena.ne.jp/entry/http://alpaca.tc/blog/vim/how-to-use-tern-vim.html" class="hatena-bookmark-button" data-hatena-bookmark-title="
JavaScript補完プラグインのTernはすごいヤツ | RailsとRubyとVimのブログ 
" data-hatena-bookmark-layout="small" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
  </div>

  <div class="button google_plus_button_like">
    <div data-annotation="none" data-href="http://alpaca.tc/blog/vim/how-to-use-tern-vim.html" class="g-plusone" data-size="medium" ></div>
  </div>

  <div class="button twitter_button">
    <a href="https://twitter.com/share" class="twitter-share-button"  data-url="http://alpaca.tc/blog/vim/how-to-use-tern-vim.html" data-via="alpaca_tc" date-width="120" data-counturl="http://alpaca.tc/blog/vim/how-to-use-tern-vim.html" ></a>
  </div>
</section>

    
  </div>
</article>

    </div>
  
    
    <div class="blog-articles">
      <article class="post_row">
  <div class="inner">
    <header class="field-items">
      
        <h1>
          
            <a href="/blog/vim/training-of-new-employee.html">
              
                Vimを使って新人教育
              
            </a>
          
        </h1>
      

      
        <section class="meta">
          <div class="inner">
            










<time datetime="2013-11-11T05:21:00+09:00" pubdate data-updated="true"></time>
            
<span class="byline author">Posted by 石井浩之</span>

            

  <span class="categories">
    
      
    
  </span>


          </div>
        </section>
      
    </header>

    
      <section class="entry-content"><p>嬉しいことに、一緒に働く仲間が2人増えました。</p>

<p>まだRubyに慣れていないそうなので、はじめの一ヶ月は教育期間を挟みます。</p>

<p>新人の方もvimmerなので、そのためのプラグインを作りました。</p>

<p><img class="image_on_frame center" src="/images/blog/11_11.png" alt="Vimのデモ" /></p>

<p><strong><a href="https://github.com/enfactv/assignment">assignment.vim</a></strong></p>

<!-- more -->

<p>インストールはごく簡単です。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NeoBundle 'alpaca-tc/assignment'`

let g:assignment#path = expand('~/path/to/assignment')
</code></pre></div></div>

<h3 id="良かったこと">良かったこと</h3>

<ul>
  <li>GitHubの使い方がわからなくても、Vimから徐々に取り組めること</li>
  <li>問題のやり取りが楽になったこと</li>
  <li>自動テストがあるので、リモート勤務でも採点できること</li>
</ul>

<h3 id="悪かったこと">悪かったこと</h3>

<ul>
  <li>一問一答の形式って効率悪いよね…</li>
</ul>

<p>とりあえず一ヶ月はこの形式で進めて、Rubyに慣れてもらおうかと思います。</p>

<h2 id="まとめ">まとめ</h2>

<p>正直、今日は書くことがなかっただけです。えへ。
暇だなー、俺初級者かなーと思う方が入れば、試しに問題に挑戦してみてください。</p>

<ol>
  <li>プラグインをインストール</li>
  <li><code class="language-plaintext highlighter-rouge">:AssignmentInit ~/インストール先ディレクトリ</code>を実行して初期化</li>
  <li>vimrcに<code class="language-plaintext highlighter-rouge">let g:assignment#path = expand('~/path/to/assignment')</code>を追加</li>
  <li><code class="language-plaintext highlighter-rouge">:Assignment solve &lt;tab&gt;</code>で問題を選択</li>
  <li>Guardをまわしながら解くのみ！</li>
</ol>

<p>初めは、8クイーン問題や、RubyのDSLを作る問題などです。
初級者向けですが、少しは暇つぶしにはなると思いますよ！</p>
</section>
      

      
    

    
      





<section class="sharing clearfix">
  <div class="button ft_like_button">
    <div class="fb-like" data-href="http://alpaca.tc/blog/vim/training-of-new-employee.html" data-colorscheme="light" data-layout="button_count" data-action="like" data-show-faces="false" data-send="false"></div>
  </div>

  <div class="button ft_share_button">
    <div class="fb-share-button" data-href="http://alpaca.tc/blog/vim/training-of-new-employee.html" data-type="button_count"></div>
  </div>

  <div class="button hatena_bookmark_button">
    <a href="https://b.hatena.ne.jp/entry/http://alpaca.tc/blog/vim/training-of-new-employee.html" class="hatena-bookmark-button" data-hatena-bookmark-title="
Vimを使って新人教育 | RailsとRubyとVimのブログ 
" data-hatena-bookmark-layout="small" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
  </div>

  <div class="button google_plus_button_like">
    <div data-annotation="none" data-href="http://alpaca.tc/blog/vim/training-of-new-employee.html" class="g-plusone" data-size="medium" ></div>
  </div>

  <div class="button twitter_button">
    <a href="https://twitter.com/share" class="twitter-share-button"  data-url="http://alpaca.tc/blog/vim/training-of-new-employee.html" data-via="alpaca_tc" date-width="120" data-counturl="http://alpaca.tc/blog/vim/training-of-new-employee.html" ></a>
  </div>
</section>

    
  </div>
</article>

    </div>
  
    
    <div class="blog-articles">
      <article class="post_row">
  <div class="inner">
    <header class="field-items">
      
        <h1>
          
            <a href="/blog/vim/plugins-best-of-vim-1.html">
              
                オススメなVimのプラグイン紹介
              
            </a>
          
        </h1>
      

      
        <section class="meta">
          <div class="inner">
            










<time datetime="2013-11-07T05:22:00+09:00" pubdate data-updated="true"></time>
            
<span class="byline author">Posted by 石井浩之</span>

            

  <span class="categories">
    
      
    
  </span>


          </div>
        </section>
      
    </header>

    
      <section class="entry-content"><p>普段使っているプラグインの中で、<em>これはイケてる！</em>と思ったプラグインを4つ紹介。</p>

<!-- more -->

<h2 id="auto-pairs"><a href="https://github.com/jiangmiao/auto-pairs">auto-pairs</a></h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">{}</code>、<code class="language-plaintext highlighter-rouge">()</code>などの、対応する文字を<em>自働入力</em></li>
  <li>括弧の片方が消えた時や、重複する時に<em>自働で調整してくれる</em></li>
  <li><code class="language-plaintext highlighter-rouge">innoremap ( ()&lt;Left&gt;</code>とか未だにやっているのダサくない？</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>" [本家](https://github.com/jiangmiao/auto-pairs)
" Lazy loading用に修正済み
NeoBundleLazy 'alpaca-tc/auto-pairs', { 'autoload' : {
      \ 'insert': 1 }}

let hooks = neobundle#get_hooks('auto-pairs')
function! hooks.on_post_source(bundle)
  call auto_pairs#try_init()
endfunction
unlet hooks
</code></pre></div></div>

<h2 id="vim-easy-align"><a href="https://github.com/junegunn/vim-easy-align">vim-easy-align</a></h2>

<ul>
  <li>使いやすさ抜群の<em>整列用プラグイン</em></li>
  <li><code class="language-plaintext highlighter-rouge">Alignta</code>がメジャーだけど、正直使いにくいよね。</li>
</ul>

<p><img class="image_on_frame center" src="https://raw.github.com/junegunn/i/master/vim-easy-align.gif" alt="vim-easy-align DEMO" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NeoBundleLazy 'junegunn/vim-easy-align', { 'autoload': {
      \ 'commands' : ['EasyAlign'] }}
</code></pre></div></div>

<h2 id="indentline"><a href="https://github.com/Yggdroot/indentLine">indentLine</a></h2>

<ul>
  <li>イケてる、<em>インデント表示プラグイン</em></li>
  <li><code class="language-plaintext highlighter-rouge">vim-indent-guides</code>は画面がうるさくなるから嫌！っていう人向け</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if has('conceal')
  NeoBundleLazy 'Yggdroot/indentLine', { 'autoload' : {
        \   'commands' : ['IndentLinesReset', 'IndentLinesToggle'],
        \   'filetypes': g:my.ft.program_files,
        \ }}
endif
</code></pre></div></div>

<h2 id="vim-multiple-cursors"><a href="https://github.com/terryma/vim-multiple-cursors">vim-multiple-cursors</a></h2>

<ul>
  <li>SublimeTextの複数マーク&amp;同時編集 の機能を実現するプラグイン</li>
  <li>実装に関しては完全に「こいつ無茶しやがって…」状態。</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NeoBundleLazy 'terryma/vim-multiple-cursors', { 'autload': {
      \ 'function_prefix': 'multiple_cursors',
      \ }}
</code></pre></div></div>

<p>今回紹介したプラグインは、かなりシンプルに洗練されています。
使っているだけでも、作者の男前さを感じられる。そんなプラグインだと思います。</p>
</section>
      

      
    

    
      





<section class="sharing clearfix">
  <div class="button ft_like_button">
    <div class="fb-like" data-href="http://alpaca.tc/blog/vim/plugins-best-of-vim-1.html" data-colorscheme="light" data-layout="button_count" data-action="like" data-show-faces="false" data-send="false"></div>
  </div>

  <div class="button ft_share_button">
    <div class="fb-share-button" data-href="http://alpaca.tc/blog/vim/plugins-best-of-vim-1.html" data-type="button_count"></div>
  </div>

  <div class="button hatena_bookmark_button">
    <a href="https://b.hatena.ne.jp/entry/http://alpaca.tc/blog/vim/plugins-best-of-vim-1.html" class="hatena-bookmark-button" data-hatena-bookmark-title="
オススメなVimのプラグイン紹介 | RailsとRubyとVimのブログ 
" data-hatena-bookmark-layout="small" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
  </div>

  <div class="button google_plus_button_like">
    <div data-annotation="none" data-href="http://alpaca.tc/blog/vim/plugins-best-of-vim-1.html" class="g-plusone" data-size="medium" ></div>
  </div>

  <div class="button twitter_button">
    <a href="https://twitter.com/share" class="twitter-share-button"  data-url="http://alpaca.tc/blog/vim/plugins-best-of-vim-1.html" data-via="alpaca_tc" date-width="120" data-counturl="http://alpaca.tc/blog/vim/plugins-best-of-vim-1.html" ></a>
  </div>
</section>

    
  </div>
</article>

    </div>
  
    
    <div class="blog-articles">
      <article class="post_row">
  <div class="inner">
    <header class="field-items">
      
        <h1>
          
            <a href="/blog/vim/break-vim-beginners-augroup.html">
              
                Vim中級者を脱する augroup編
              
            </a>
          
        </h1>
      

      
        <section class="meta">
          <div class="inner">
            










<time datetime="2013-11-02T02:30:00+09:00" pubdate data-updated="true"></time>
            
<span class="byline author">Posted by 石井浩之</span>

            

  <span class="categories">
    
      
    
  </span>


          </div>
        </section>
      
    </header>

    
      <section class="entry-content"><h2 id="augroup-autocmdを理解する">augroup, autocmdを理解する</h2>

<p><strong>所要時間 3分</strong></p>

<h3 id="この記事を読むべき人">この記事を読むべき人</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">augroup</code>を理解していない人</li>
  <li><code class="language-plaintext highlighter-rouge">:source</code>コマンドを使う人</li>
</ul>

<!-- more -->

<h2 id="そもそもautocmdって">そもそもautocmdって？</h2>

<p>これは何をしているコマンドなのか分解してみましょう。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>autocmd BufNewFile * echo 'This is new file'
</code></pre></div></div>

<ol>
  <li>autocmdのコマンドを開始しますよ</li>
  <li><code class="language-plaintext highlighter-rouge">BufNewFile</code>というタイミングでこのコマンドを実行しますよ</li>
  <li>全てのバッファで<code class="language-plaintext highlighter-rouge">echo 'This is new file'</code>を実行しますよ</li>
</ol>

<p>となります。</p>

<p>このように、保存時や新規のファイルといったタイミングでコマンドを実行できます。</p>

<h2 id="ではaugroupはなんのために存在するの">では、augroupはなんのために存在するの？</h2>

<p><code class="language-plaintext highlighter-rouge">augroup</code>は、<code class="language-plaintext highlighter-rouge">autocmd</code>をグループでまとめるためのコマンドです。こんな感じて使われます。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>augroup EditNewFile
  autocmd!
  autocmd BufNewFile * echo 'This is new file'
augroup END
</code></pre></div></div>

<p>例えば、<code class="language-plaintext highlighter-rouge">autocmd</code>が設定されているvimrcを、<code class="language-plaintext highlighter-rouge">:source ~/.vimrc</code>で再度読み込むとしましょう。</p>

<p>するとどうなるかというと、通常は<strong><code class="language-plaintext highlighter-rouge">autocmd</code>が重複して2度設定されます</strong>
当然、その<code class="language-plaintext highlighter-rouge">autocmd</code>が発火するときに2度実行されるので、実行が遅くなります。</p>

<p>それを防ぐために<code class="language-plaintext highlighter-rouge">augroup</code>を使います。</p>

<h2 id="ベストプラクティスは">ベストプラクティスは？</h2>

<p>つまるところ、<code class="language-plaintext highlighter-rouge">augroup</code>は<code class="language-plaintext highlighter-rouge">autocmd</code>をまとめて初期化する場合に使用します。
具体例を上げると、下記のような形になります。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>augroup MyAutoCmd
  autocmd! " =&gt; このaugroupに紐づいたautocmdを消し去ります
augroup END

...

augroup MyAutoCmd
  autocmd BufNewFile * echo 'This is new file'
  autocmd BufNewFile,BufRead *.haml setf haml
augroup END
</code></pre></div></div>

<p>こうすることで、2重に設定されることのない設定になります。</p>

<h2 id="もう一歩踏み込んでみる">もう一歩踏み込んでみる</h2>

<p>autocmdの設定方法をVimのRuntimeから学んでみましょう。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:edit $VIMRUNTIME/filetype.vim
</code></pre></div></div>

<p>これはファイルタイプの定義を行っているファイルです。</p>

<p>augroupが宣言されているので、一覧を<code class="language-plaintext highlighter-rouge">:autocmd filetypedetect</code>でみれることが分かります。</p>

<p>驚くことに、もの凄い数のコマンドを実行してファイルタイプを設定していることが分かります。</p>

<h3 id="ftdetectを知る">ftdetectを知る</h3>

<p>filetype.vimにて<code class="language-plaintext highlighter-rouge">runtime! ftdetect/*.vim</code>と書かれており、<code class="language-plaintext highlighter-rouge">~/.vim/ftdetect/*</code>を読み込んでいることが分かります。</p>

<p>つまり、ファイルタイプの設定は<code class="language-plaintext highlighter-rouge">ftdetect</code>以下で設定するのがベターとされています。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>" ~/.vim/ftdetect/coffee.vim
autocmd BufNewFile,BufRead *.coffee    setf coffee
</code></pre></div></div>

<p>といった設定にて、ファイルタイプを検出できるようになります。
<code class="language-plaintext highlighter-rouge">augroup filetypedetect</code>の宣言内なので、グループの宣言は不要です。</p>

<h2 id="本日の脱vim中級者">本日の脱Vim中級者</h2>

<p>vimrcでファイルタイプの検出をしている方は、<code class="language-plaintext highlighter-rouge">~/.vim/ftdetect</code>以下に設定を移してみましょう。</p>
</section>
      

      
    

    
      





<section class="sharing clearfix">
  <div class="button ft_like_button">
    <div class="fb-like" data-href="http://alpaca.tc/blog/vim/break-vim-beginners-augroup.html" data-colorscheme="light" data-layout="button_count" data-action="like" data-show-faces="false" data-send="false"></div>
  </div>

  <div class="button ft_share_button">
    <div class="fb-share-button" data-href="http://alpaca.tc/blog/vim/break-vim-beginners-augroup.html" data-type="button_count"></div>
  </div>

  <div class="button hatena_bookmark_button">
    <a href="https://b.hatena.ne.jp/entry/http://alpaca.tc/blog/vim/break-vim-beginners-augroup.html" class="hatena-bookmark-button" data-hatena-bookmark-title="
Vim中級者を脱する augroup編 | RailsとRubyとVimのブログ 
" data-hatena-bookmark-layout="small" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
  </div>

  <div class="button google_plus_button_like">
    <div data-annotation="none" data-href="http://alpaca.tc/blog/vim/break-vim-beginners-augroup.html" class="g-plusone" data-size="medium" ></div>
  </div>

  <div class="button twitter_button">
    <a href="https://twitter.com/share" class="twitter-share-button"  data-url="http://alpaca.tc/blog/vim/break-vim-beginners-augroup.html" data-via="alpaca_tc" date-width="120" data-counturl="http://alpaca.tc/blog/vim/break-vim-beginners-augroup.html" ></a>
  </div>
</section>

    
  </div>
</article>

    </div>
  

  <div class="pagination">
    
      <a  data-label="前" class="paging_number prev" href="/blog/page/5/">&larr; 前の記事へ</a>
    

    
      
      
      
      
    
      
      
      
      
    
      
      
      
      
    
      
      
      
      
        <a class="paging_number " href="/blog/page/4/">4</a>
      
    
      
      
      
      
        <a class="paging_number " href="/blog/page/5/">5</a>
      
    
      
      
      
      
        <a class="paging_number current" href="/blog/page/6/">6</a>
      
    
      
      
      
      
        <a class="paging_number " href="/blog/page/7/">7</a>
      
    

    
      <a data-label="次" class="paging_number next" href="/blog/page/7/">次の記事へ &rarr;</a>
    
  </div>

  <script type="text/javascript" charset="utf-8">
    (function() {
      $(function() {
        var isSmartPhone = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());
        if (isSmartPhone) {
          var $pagination = $('.pagination'),
          $prev = $pagination.find('.prev'),
          $next = $pagination.find('.next');
          $prev.text($prev.data('label'));
          $next.text($next.data('label'));
        }
      });
    })();
  </script>
</div>

              </div>
            </div>

            <aside id="sidebar" class="right_page inner_wrapper">
  
<section id="side_category_posts" class="sidebar_row">
  <div id="blog-archives" class="category">
    <h1>最新記事</h1>
    
      <article>
        <time datetime="2020-12-18T17:21:00+09:00" pubdate><span class='month'>Dec</span> <span class='day'>18</span> <span class='year'>2020</span></time>
        <h1><a href="/blog/ruby/kamipo-san-no-advice-to-kyoten-wo-mataida-benkyou-kai.html">kamipoさんのアドバイスと拠点を跨いだ勉強会</a></h1>
      </article>
    
      <article>
        <time datetime="2017-07-03T00:03:00+09:00" pubdate><span class='month'>Jul</span> <span class='day'>03</span> <span class='year'>2017</span></time>
        <h1><a href="/blog/pixiv/job/i_retired_from_pixiv.html">ピクシブを退職しました！</a></h1>
      </article>
    
  </div>
</section>

  




  
    <section id="side_about_me" class="sidebar_row">
  <h1>プロフィール</h1>
  <section>
    <figure class="image_wrapper">
      <img src="/images/common/profile.jpg" alt="石井 浩之">
      <figcaption>石井 浩之</figcaption>
    </figure>

    <p>
      アルパカ大好きエンジニア
    </p>

    <p class="go_to_aboutme">
      <a href="/about_me">→詳しく見る</a>
    </p>
  </section>
</section>

  

  <section id="side_sharing" class="sidebar_row">
  <div class="button hatena_bookmark_button">
    <a href="https://b.hatena.ne.jp/entry/http://alpaca.tc" class="hatena-bookmark-button" data-hatena-bookmark-title="RailsとRubyとVimのブログ" data-hatena-bookmark-layout="small" data-hatena-bookmark-lang="ja" title="このブログをはてなブックマークに追加">
      <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このブログをはてなブックマークに追加" width="20" height="20" style="border: none;" />
    </a>
  <!-- </div> -->
</section>


  <section id="side_twitter_timeline_widget" class="sidebar_row">
  <a class="twitter-timeline" href="https://twitter.com/alpaca_tc" data-widget-id="395937677314232320">@alpaca_tc からのツイート</a>
</section>

</aside>

          </div>
        </div>
      </div><!-- /div#main_contents -->

      <footer role="contentinfo">        <div class="inner_wrapper">
          <div class="inner">
            <div id="go_to_top" class="clearfix">
              <p><a href="#header_top">Go to Top</a></p>
            </div>
          </div>
        </div>

        <div class="inner_wrapper">
          <div class="inner">
            <div id="footer_link" class="clearfix">
              <nav id="footer_nav">
                <ul class="clearfix">
                  <li>
                    <a rel="nofollow" href="/about_me">About Me</a>
                  </li>
                  <li>
                    <a href="/">Blog</a>
                  </li>
                  <li>
                    <a rel="nofollow" href="/works/">Works</a>
                  </li>
                </ul>
              </nav>


              <nav id="footer_social_link">
                <ul class="clearfix">
                  <li class="qiita">
                    <a href="mailto:alprhcp666@gmail.com">
                      <img src="/images/social/icon_mail.png" alt="Send mail to alpaca-tc">
                    </a>
                  </li>
                  <li class="github">
                    <a target="_blank" href="https://github.com/alpaca-tc">
                      <img src="/images/social/icon_github.png" alt="Github @alpaca-tc">
                    </a>
                  </li>
                  <li class="twitter">
                    <a target="_blank" href="https://twitter.com/alpaca_tc">
                      <img src="/images/social/icon_twitter.png" alt="Twitter @alpaca_tc">
                    </a>
                  </li>
                </ul>
              </nav>

            </div>
          </div>
        </div>
        <div id="footer_mark">
          <small>&nbsp;&copy; 2013, alpaca.tc</small>
        </div>
        <script>
(function(w, d) {
  load_javascript();
  window.onload = function () {
    setTimeout(function() { lazy_load_javascript(); }, 100);
  };

  function insert_javascript(u, i) {
    var s, e = d.getElementsByTagName('script')[0];
    if (!d.getElementById(i)) {
      s = d.createElement('script');
      s.src = u;
      s.async = true
      if (i) {
        s.id = i;
      }
      e.parentNode.insertBefore(s, e);
    }
  };

  function lazy_load_javascript() {
    insert_javascript('//platform.twitter.com/widgets.js', 'twitter-wjs');
    insert_javascript('//connect.facebook.net/ja_JP/all.js#xfbml=1&appId=224701561024840', 'facebook-jssdk');
    insert_javascript('//apis.google.com/js/plusone.js');
  }

  function load_javascript() {
    insert_javascript('//b.st-hatena.com/js/bookmark_button_wo_al.js');
    insert_javascript('//alpaca-tc.disqus.com/embed.js');
  }
})(this, document);
</script>

</footer>
    </div>
  </body>
</html>
